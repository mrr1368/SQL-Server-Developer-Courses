# ๐ ุฌูุณู ุดุงูุฒุฏูู - ุชูุงุจุน ูพุงุฑุงูุชุฑุ APPLYุ ู Stored Procedures ุจุง ูุฏุฑุช ุฎุทุง ุฏุฑ SQL Server

ุฏุฑ ุงู ุฌูุณู ุจุง ุชฺฉูฺฉโูุง ูพุดุฑูุชู ุฏุฑ ฺฉุงุฑ ุจุง ุชูุงุจุน ูพุงุฑุงูุชุฑุ ุฏุณุชูุฑุงุช APPLYุ ู ุณุงุฎุช Stored Procedureูุง ุจุง ูุฏุฑุช ุฎุทุง ุขุดูุง ูโุดูู. ุงู ููุงุฑุชโูุง ุจุฑุง ุจูููโุณุงุฒ ฺฉูุฆุฑโูุง ู ฺฉูุชุฑู ุจูุชุฑ ุนููุงุช ุฏุฑ SQL Server ุจุณุงุฑ ุถุฑูุฑ ูุณุชูุฏ.

---

## ๐บ๏ธ ุฎูุงุตูโ ุณุฑุน ููุถูุนุงุช ุงู ุฌูุณู

| ุฏุณุชูุฑ ุง ููููู | ุชูุถุญ |
|:---|:---|
| `Scalar-Valued Functions (SVF)` | ุณุงุฎุช ุชูุงุจุน ุฎุฑูุฌ ุชฺฉโููุฏุงุฑ ุจุฑุง ูุญุงุณุจูโูุง ุฎุงุต |
| `Table-Valued Functions (TVF)` | ุณุงุฎุช ุชูุงุจุน ุจุงุฒฺฏุดุช ฺูุฏุฑุฏู ุจุง ุง ุจุฏูู ูพุงุฑุงูุชุฑ |
| `CROSS APPLY` ู `OUTER APPLY` | ุงุชุตุงู ุชูุงุจุน ุจู ุฌุฏุงูู ุจุฑุง ฺฉูุฆุฑโูุง ูพูุง |
| `STRING_SPLIT` ู `PIVOT` | ุชุฌุฒู ุฑุดุชูโูุง ู ุณุงุฎุชุงุฑุฏู ุฏุงุฏูโูุง ุจู ุตูุฑุช ุฌุฏูู |
| `Stored Procedures with TRY...CATCH` | ุงุฌุงุฏ SP ุจุง ูุฏุฑุช ุญุฑููโุง ุฎุทุง |

---

## ๐๏ธ ฺุฒูุง ฺฉู ุฏุฑ ุงู ุฌูุณู ุงุฏ ูโฺฏุฑู

### ๐ฏ ฺฉุงุฑ ุจุง ุชูุงุจุน ุงุณฺฉุงูุฑ ู ุฌุฏูู (SVF & TVF)

- ุณุงุฎุช ุชุงุจุน ุงุณฺฉุงูุฑ `svfPublishersAmount` ุจุฑุง ูุญุงุณุจู ูุฌููุน ูุฑูุด ุจุฑ ุงุณุงุณ ุดูุงุณู ูุงุดุฑ

- ุชุนุฑู ุชุงุจุน ุฌุฏูู `tvfPublishersAmount` ุจุฑุง ุจุงุฒฺฏุฑุฏุงูุฏู ฺูุฏู ุฑุฏู ุงุทูุงุนุงุช ูุฑูุด

- ููุงุณู ูุฒุงุง ู ฺฉุงุฑุง ุชูุงุจุน TVF ูุณุจุช ุจู ูููุง (View)

---

### ๐ฏ ุงุณุชูุงุฏู ุงุฒ APPLY ุฏุฑ ฺฉูุฆุฑโูุง

- ุงุณุชูุงุฏู ุงุฒ `CROSS APPLY` ู `OUTER APPLY` ุจุฑุง ุงุฑุชุจุงุท ุฑฺฉูุฑุฏูุง ุจุง ุชูุงุจุน ูพุงุฑุงูุชุฑ

- ููุงุด ุงุทูุงุนุงุช ูุงุดุฑุงู ู ููุณูุฏฺฏุงู ุจู ุตูุฑุช ูพูุง ุจุฑ ุงุณุงุณ ุดุฑุงุท ูุชุบุฑ

---

### ๐ฏ ูพุฑุฏุงุฒุด ุฑุดุชูโูุง ู ุณุงุฎุชุงุฑุฏู ุฏุงุฏูโูุง

- ุชุฌุฒู ุฏุงุฏูโูุง ูุชู ุจุง ุงุณุชูุงุฏู ุงุฒ `STRING_SPLIT`

- ุงุฌุงุฏ ุฌุฏุงูู ฺุฑุฎุด (Pivot Table) ุงุฒ ุฑู ุฑุดุชูโูุง ุฌุฏุง ุดุฏู ุจุง `PIVOT`

---

### ๐ฏ ุงุฌุงุฏ Stored Procedure ู ูุฏุฑุช ุฎุทุง

- ุทุฑุงุญ Stored Procedureูุง ูุงููุฏ `spJobsInsert` ู `spTitlesUpdate`

- ุฏุฑุงูุช ู ููุงุด ุฎุทุงูุง ุจุง TRY...CATCH ู ุชูุงุจุน ุณุณุชู ูุซู `ERROR_MESSAGE()`, `ERROR_NUMBER()`, `ERROR_SEVERITY()`

- ูููููโุณุงุฒ ุฎุฑูุฌ ู ูุดุงูุฏู ููุงุฏุฑ ุชุบุฑ ุงูุชู ุจุง `OUTPUT`

---

## ๐ ุฏุฑุจุงุฑู ุงู ุฌูุณู

ุฏุฑ ุงู ุฌูุณู ุชูุฑู ูโฺฉูู:
- ฺุทูุฑ ุชูุงุจุน ุญุฑููโุง ุจุณุงุฒู ู ุฏุฑ ฺฉูุฆุฑโูุง ุงุณุชูุงุฏู ฺฉูู.
- ฺุทูุฑ APPLY ุฑุง ุจุฑุง ุงุชุตุงู ุชูุงุจุน ุจู ุฏุงุฏูโูุง ุงุตู ุจู ฺฉุงุฑ ุจุจุฑู.
- ฺุทูุฑ ุฏุงุฏูโูุง ูุชู ุฑุง ุจู ูุฑูุช ุฌุฏูู ุชุจุฏู ฺฉูู.
- ฺุทูุฑ Stored Procedureูุง ููุงูู ุจู ุฎุทุง ุจููุณู.

ุชูุงู ุชูุฑูโูุง ุฑู ุฏุชุงุจุณ **T_pubs** ุงูุฌุงู ุดุฏูโุงูุฏ.

---

## ๐ ูุงู ููุฌูุฏ

- `Session 16.sql`: ุดุงูู ูููููโูุง ฺฉุงูู ุงุฒ ุชูุงุจุน ูพุงุฑุงูุชุฑุ APPLYุ ุชุญูู ุฑุดุชูโุงุ ู Stored Procedures ุจุง ูุฏุฑุช ุฎุทุง.

---

## โก ูฺฉุงุช ููู

- TVFูุง ุจุฑุง ฺฉูุฆุฑโูุง ูพฺุฏู ูุนูููุงู ูุณุจุช ุจู ูููุง ุงูุนุทุงูโูพุฐุฑุชุฑ ู ูุงุจู ูฺฏูุฏุงุฑโุชุฑ ูุณุชูุฏ.
- ุงุณุชูุงุฏู ุงุฒ `CROSS APPLY` ุจุงุนุซ ุจูุจูุฏ ุณุฑุนุช ู ุฏูุช ฺฉูุฆุฑโูุง ุดุฑุท ูโุดูุฏ.
- ูพุงุฏูโุณุงุฒ ุฏุฑุณุช TRY...CATCH ุฏุฑ SPูุง ุงูฺฉุงู ูุฏุฑุช ุญุฑููโุง ุฎุทุงูุง ุฑุง ูุฑุงูู ูโฺฉูุฏ.

---

> โจ ุงู ุฌูุณู ฺฏุงู ุจุฒุฑฺฏ ุจุฑุง ุณุงุฎุช ุณุณุชูโูุง ุญุฑููโุงโุชุฑุ ูุงุจู ูฺฏูุฏุงุฑโุชุฑ ู ููุงููโุชุฑ ุฏุฑ ุจุฑุงุจุฑ ุฎุทุง ุฏุฑ SQL Server ุงุณุช.

