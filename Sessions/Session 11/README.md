# 📚 جلسه یازدهم - آشنایی ساده با توابع تحلیلی (Analytic Functions) و پنجره‌ها (Window Functions)

در این جلسه یاد می‌گیریم چطور با توابع خاصی در SQL Server کار کنیم که به ما اجازه می‌دهند اطلاعات را دقیق‌تر و بهتر تحلیل کنیم. این روش‌ها کمک می‌کنند بدون حذف داده‌ها، محاسبات جالبی روی هر ردیف انجام بدهیم. این کار باعث می‌شود گزارش‌های دقیق‌تر و هوشمندتری بسازیم.

این موضوعات زمانی خیلی به درد می‌خورند که بخواهیم با داده‌های زیاد کار کنیم، گزارش‌های کامل درست کنیم یا اطلاعات مالی را تحلیل کنیم.

---

## 🛠️ چیزهایی که در این جلسه یاد می‌گیریم

### 🎯 توابع رتبه‌بندی (Ranking Functions)

| دستور | توضیح |
|:---|:---|
| `ROW_NUMBER()` | شماره‌گذاری ردیف‌ها به ترتیب خاص |
| `RANK()` | رتبه‌بندی ردیف‌ها با درنظر گرفتن رکوردهای تکراری |
| `DENSE_RANK()` | رتبه‌بندی بدون ایجاد فاصله بین رتبه‌ها |
| `NTILE()` | تقسیم رکوردها به گروه‌های مساوی |

### 🎯 توابع تجمیعی با پنجره (Aggregation with Window)

| دستور | توضیح |
|:---|:---|
| `SUM() OVER()` | محاسبه مجموع روی تمام ردیف‌ها یا یک گروه خاص بدون خلاصه کردن داده‌ها |
| `AVG() OVER()` | محاسبه میانگین روی داده‌های گروه‌بندی نشده |
| `COUNT() OVER()` | شمارش رکوردها بدون گروه‌بندی سنتی |

### 🎯 مباحث پیشرفته تحلیل داده

| موضوع | توضیح |
|:---|:---|
| مقایسه ردیف‌ها | مقایسه مقدار هر ردیف با مقدار میانگین یا مجموع کل |
| Share of Total | محاسبه درصد سهم هر ردیف نسبت به مجموع کل |
| Frame Definitions | تعیین بازه محاسبات روی داده‌ها مثل `ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW` |
| `SET STATISTICS IO` | بررسی مصرف منابع و بهبود کارایی کوئری‌ها |

---

## 📜 درباره این جلسه

در این جلسه یاد می‌گیریم:
- چطور شماره‌ی هر ردیف را پیدا کنیم.
- چطور میانگین و مجموع را بدون گروه‌بندی معمولی محاسبه کنیم.
- چطور براساس شرط‌های مختلف ستون‌های جدید درست کنیم.
- چطور کوئری‌هایی بنویسیم که هم دقیق باشند هم سریع.

تمرین‌ها روی دیتابیس‌های آموزشی **T_pubs** و **AdventureWorks** انجام شده تا یادگیری راحت‌تر شود.

این جلسه خیلی مهم است و کمک می‌کند کار با SQL را حرفه‌ای‌تر یاد بگیریم.

---

## 📂 فایل موجود

- `Session 11.sql`: شامل نمونه‌های واقعی از کار با Window Functions، توابع رتبه‌بندی، و تحلیل‌های پیشرفته‌ی داده‌ها.

---

## ⚡ نکات مهم

- توابع تحلیلی به ما این امکان را می‌دهند که روی هر ردیف داده محاسبه انجام دهیم بدون اینکه چیزی از دست برود.
- باید فرق `ROW_NUMBER()`, `RANK()` و `DENSE_RANK()` را خوب بفهمیم تا از هرکدام درست استفاده کنیم.
- تعریف دقیق Frameها می‌تواند سرعت و دقت کار ما را بیشتر کند.
- با `OVER()` می‌توانیم محاسباتی انجام بدهیم که نیازی به گروه‌بندی معمولی نداشته باشند.
- چک کردن مصرف منابع (IO) به ما کمک می‌کند کوئری‌هایی بنویسیم که بهتر و سریع‌تر اجرا شوند.

---

> ✨ این جلسه یک قدم خیلی بزرگ به سمت تحلیل‌های حرفه‌ای‌تر در SQL است و چیزهایی که یاد می‌گیریم هم در پروژه‌های کوچک و هم در پروژه‌های بزرگ خیلی به درد می‌خورند.

